function preLoadImage(e){var t=new Image;t.src="dist/img/"+e+".jpg",t.onload=console.log("image loaded: "+e)}function currentQuestion(){return parseInt(document.getElementById("q_id").value)+1}function questionHTML(e){var t="<legend>"+e.question+"</legend>";return t+=expressionHTML(e.expression[0])+expressionHTML(e.expression[1])}function expressionHTML(e){return'<label class="exp"><input class="exp_input" type="radio" name="expression" value="'+e.name+'" /><img class="face" src="dist/img/'+e.image+'" alt="" /><span class="sr">'+e.description+"</span></label>"}document.addEventListener("DOMContentLoaded",function(t){var n=document.getElementById("btn--submit");n.className="btn hidden";var a=document.getElementById("assessment"),s=document.getElementById("question"),r=document.getElementById("progress__cqn"),o=document.getElementById("progressbar"),i=parseInt(document.getElementById("tq").value),u=new XMLHttpRequest;u.onreadystatechange=function(){var e=document.getElementById("message");null!==e&&e.parentNode.removeChild(e),4===u.readyState&&200===u.status&&(json=JSON.parse(u.responseText),json.error.length?append_error(json.error):(new_question(json),updateValues(json),updateProgressbar()))},nextQuestionKeyDownListener=function(e){if(!e.target||"exp_input"!==e.target.className)return!1;var t=e.x||e.clientX,n=e.y||e.clientY;return!t&&!n&&(console.log(e.keyCode),void(13===e.keyCode&&(e.target.checked!==!0&&(e.target.checked=!0),nextState(e))))},nextQuestionMouseDownListener=function(e){if("exp"!==e.target.parentNode.className&&"exp"!==e.target.className)return!1;var t;if("face"===e.target.className)t=e.target.parentElement.children[0];else if("enp_input"===e.target.className)t=e.target;else{if("exp"!==e.target.className)return;t=e.target.children[0]}t.checked!==!0&&(t.checked=!0),nextState(e)},s.addEventListener("mouseup",nextQuestionMouseDownListener),s.addEventListener("keydown",nextQuestionKeyDownListener),new_question=function(e){s.className="q-remove",s.innerHTML=questionHTML(e.question),setTimeout(removeQuestionClass,500),s.parentElement.focus()},removeQuestionClass=function(){s.className="q-on-deck"},append_error=function(e){var t='<section id="message" class="message message--error" role="alertdialog" aria-labelledby="message__title" aria-describedby="enp-message__list"><h3 class="message__title message__title--error">Error</h3><ul class="enp-message__list"><li class="enp-message__item">'+e[0]+"</li></ul></section>";n.insertAdjacentHTML("afterend",t)},nextState=function(e){currentQuestion()!==i?(e.preventDefault(),formData=new FormData(a),formData.append("ajax",!0),u.open("POST",a.action),u.send(formData)):n.click()},updateProgressbar=function(){var e=currentQuestion();r.innerText=e,o.style.width=e/i*100+"%",o.setAttribute("aria-valuenow",e)},updateValues=function(e){updateValue("ac",e.answered_correctly),updateValue("phrase_ac",e.phrase_answered_correctly),updateValue("application_ac",e.application_answered_correctly),updateValue("q_id",e.current_question_number)},updateValue=function(t,n){e=document.getElementById(t),e.value=n}}),window.onload=function(){for(var e=["happy","sad","scared","angry","distracted"],t=0;t<e.length;t++)preLoadImage(e[t])};